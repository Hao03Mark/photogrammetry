# 空间前方交会

## 题目
1. 给定两影像的外方位元素，内方位元素和同名点坐标，采用点投影系数法求解三维坐标初始值，采用严密解法求解其真值，数据为实时生成，见 `problem.h` 文件中的 `DataIntersection` 和对应的 `generate_intersection` 函数。

2. 根据给定的同名点坐标和固定的基线 $B_x$ 长度，采用连续法相对定向方法，计算左、右影像的相对旋转平移参数

3. 根据上述计算的相对定向结果，首先计算模型坐标，然后利用给定的控制点，进行绝对定向，最终解算出左、右影像在世界坐标系的坐标。

## 编辑方法
- 编辑 `problem3/problem1.cpp` 文件中的 `intersection_similarity_transform` 采用点投影系数法求解，`intersection_least_squares` 用严密法求解

- 编辑 `problem3/problem2.cpp` 文件中的 `relative_orientation` 获取两影像在固定基线长度 $B_x$ 下的相对旋转平移

- 编辑 `problem3/problem3.cpp` 文件中的 `absolute_orientation`，首先根据相对定向方法，计算相对模型的模型坐标，然后根据提供的控制点，进行绝对定向，输出左、右像的外方位元素。

- 在 `<common.hpp>` 头文件中提供了一些简单的基本函数。

## 相对定向元素与外方位元素的关系

-例1：已知两影像的外方位元素 $(R_1,C_1)$ 和 $(R_2,C_2)$ ，求出采用连续法相对定向元素 $(R,B)$

定义一个物方点 $X=(X,Y,Z)^T$ 为世界坐标系中坐标，其在某相机的相机坐标系的坐标为 $X^C$ ，在相对定向模型坐标系的像空间辅助坐标系坐标值为 $X^M$。

那么依据共线方程，有如下关系：
> $X^C_1 = R_1^T(X-C_1), X^C_2=R_2^T(X-C_2)$

依据相对定向坐标系的基本关系有：
> $X_1^M=X_2^M+B$ 即 $X_1^C=RX_2^C+B$

因此只要将共线方程推导出的关系式，写成相对定向的形式，即可得出相对定向元素与外方位元素关系
> $R_1X_1^C+C_1=R_2X_2^C+C_2$ 可得到 $X_1^C=R_1^TR_2X_2^C+R_1^T(C_2-C_1)$

所以有
> $R=R_1^TR_2$ 和 $B=R_1^T(C_2-C_1)$